{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],
  "dependencyDashboardApproval": false,
  "argocd": {
    "fileMatch": ["apps/.+\\.yaml$"]
  },
  "packageRules": [
    {
      "matchManagers": ["argocd"],
      "matchPackagePatterns": ["*"],
      "enabled": true
    },
    {
      "matchManagers": ["argocd"],
      "matchPackagePatterns": ["ghcr.io/**"],
      "enabled": false,
      "description": "Disable ArgoCD manager for ghcr.io OCI charts - handled by custom regex manager"
    },
    {
      "matchManagers": ["regex"],
      "matchPackagePatterns": ["ghcr.io/**"],
      "automerge": false,
      "description": "OCI Helm charts from ghcr.io"
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "fileMatch": ["apps/.+\\.yaml$"],
      "matchStrings": [
        "repoURL:\\s*(?<registryUrl>ghcr\\.io/[^\\s]+)\\s+chart:\\s*(?<depName>[^\\s]+)\\s+targetRevision:\\s*(?<currentValue>[^\\s]+)"
      ],
      "datasourceTemplate": "docker",
      "packageNameTemplate": "{{{registryUrl}}}/{{{depName}}}"
    }
  ]
}
